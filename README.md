# magnit
magnit
magnit test_tasks

## TASK_1
Задача 1:
Проведите аналитику полученных данных
Подготовьте данные для регрессионной модели
Обучите регрессионную модель и осуществите прогноз на последний месяц для поля SALES
Оцените качество модели с помощью функции metric

###  Инструкция к решению:
Для получения аналитического отчета с программным кодом к данному заданию необходимо иметь локально сохраненные файлы:

"task1_Iurina.ipynb" {файл содержит программный код с ответами на задание}
"data_regression_for_task.csv"{в файле содержится датасет к задаче 1}.

### Чтобы посмотреть аналитический отчет с программным кодом, необходимо открыть в jupiter:

файл "test_Yurina_task1.ipynb" В нем нужно запустить код

Результат специально запрошенной в задаче метрики, оценивающей модель бустинга либо леса, с помощью валидации достигает около 75% на тестовой выборке

## Задача 2:
Проведите аналитику полученных данных
Подготовьте данные для модели классификации
Обучите модель классификации и осуществите прогноз для отложенной выборки с учетомо перекоса в данных TARGET
Оцените качество модели с помощью функции f1_score

###  Инструкция к решению:
Для получения аналитического отчета с программным кодом к данному заданию необходимо иметь локально сохраненные файлы:

"task1_Iurina.ipynb" {файл содержит программный код с ответами на задание}
"data_classification_for_task.csv"{в файле содержится датасет к задаче 2}.

### Чтобы посмотреть аналитический отчет с программным кодом, необходимо открыть в jupiter:

файл "test_Yurina_task1.ipynb" В нем нужно запустить код

Результат f1_score метрики, оценивающей модель бустинга либо леса, с помощью валидации достигает около 84% на тестовой выборке



## TASK_2
есть расписания поставщиков 'shedulers.csv', заданное видом ДДННССВВ, где Д - дневная смена, Н - ночная смена, С - суточная смена, В - выходной

Считать что дневная смена с 08:00 по 20:00 Считать что ночная смена с 20:00 по 08:00 Считать что суточная смена с 08:00 по 08:00 завтрашнего дня

Описание работы расписания ДНСВ: 1 день - Д дневная смена 2 день - Н ночная смена 3 день - С суточная смена 4 день - В выходной день 5 день - Д дневная смена и т.д. циклично

## Задание 1
Создать таблицу (T_CONTRACTOR_SHERULER) под расписание и заполнить его с файла schedulers.csv. (Использовать любую библиотеку для заливки в СУБД (как вариант MS SQL)) Таблицу следует нормализовать.

ID_NAME - идентификтор поставщика
NAME - название поставщика
SHEDULE - расписание
DATE_BEGIN - дата начала действия расписания
DATE_END - дата окончания действия расписания
Пример записи без нормализации:

Поставщик 1 ДВС 01.01.2019 04.01.2019
Поставщик 2 НВС 05.01.2019 31.12.2019
Вводные:

Связку полей FIO, DATE_BEGIN считать уникальной.
DATE_BEGIN не может привышать DATE_END.
Можете продемонстрировать работу с ключами/ограничениями.

## Задание 2
Создать таблицу (T_CONTRACTOR_WORK_DAY) выходов на работу сотрудников.

Таблица должна иметь следующий вид

ID - идентификатор записи
NAME - название поставщика
DATE_BEGIN - Начало рабочего дня (datetime)
DATE_END - Конец рабочего дня (datetime)
## Задание 3
Создать процедуру расчета рабочих дней.

Входящие параметры:

Дата начала периода расчета
Дата окончания периода расчета.
Ожидаемый результать выполнения хранимой процедуры - заполнение таблицы T_CONTRACTOR_WORK_DAY рабочими днями согласно расписания работы поставщиков из таблицы T_CONTRACTOR_SHERULER Выходные дни (В) не должны попадать в таблицу T_CONTRACTOR_WORK_DAY

Пример выполнения для Поставщика 1 (Из примера записи таблицы T_CONTRACTOR_SHERULER) с параметрами '01.01.2019' - '08.01.2019' таблица T_CONTRACTOR_WORK_DAY заполнится следующими данными:

1 Поставщик 1 01.01.2019 08:00 01.01.2019 20:00
2 Поставщик 1 03.01.2019 08:00 04.01.2019 08:00
3 Поставщик 1 04.01.2019 08:00 04.01.2019 08:00
4 Поставщик 1 05.01.2019 20:00 06.01.2019 08:00
5 Поставщик 1 07.01.2019 08:00 08.01.2019 08:00
6 Поставщик 1 08.01.2019 20:00 09.01.2019 08:00
Пояснение: для записей с 01.01.2019 по 04.01.2019 берется расписание ДВС

1 - Д - дневная смена далее следует выходной В - запись о выходном дне не попадает в таблицу
2 - С - суточная смена
3 - расписание закончилось, поэтому оно циклично начинается с начала (Д - дневная смена)
4 - С 05.01.2019 начинает действовать новое расписание - НВС берется Н - ночная смена далее следует выходной В - запись о выходном дне не попадает в таблицу
5 - С - суточная смена
6 - Снова Н - ночная смена
## Задание 4
С помощью SQL запросов:

Сделать выборку содержащую сколько рабочих дней было у каждого поставщика
Сделать выборку поставщиков, у которыйх было больше 10 рабочих дней за январь 2019 года
Сделать выборку поставщиков, кто работал 14, 15 и 16 января 2019 года
## Задание 5
Выполните задачи 3, 4 с помощью python.


### Инструкция к решению:
Для получения аналитического отчета с программным кодом к данному заданию необходимо иметь локально сохраненные файлы:

"task2_Iurina.ipynb" {файл содержит программный код с ответами на задание по блоку SQL, используется SQL сервер}
"task2_Iurina_python.ipynb" {файл содержит программный код со скриптами запуска и ответами на задание по блоку python (Задание 5}

"shedulers.csv"{файл содержит исходный датасет с расписанием}.
"task_2_python.py", "feature_df.py", "forming_WORK_DAY_row.py", "one_id_schedule.py", "result_df.py" {файлы содержат скрипты с функциями, которые необходимы для выполнения кода}

### Чтобы посмотреть аналитический отчет с программным кодом по блоку SQL, необходимо запустить в SQL сервер скрипты, которые содержатся в файле "task2_Iurina.ipynb" и иметь локально сохраненный файл 'shedulers.csv'


### Чтобы посмотреть аналитический отчет с программным кодом по блоку python, необходимо открыть в jupiter:

файл "task2_Iurina_python.ipynb" В нем нужно запустить код
